<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.devwareProject.BoardMapper">
<insert id="insertBoard" parameterType="Board" >
	INSERT INTO Board values(#{emp_num},     
	                         #{brd_type},
	                        <choose>
	                        	<when test="brd_type==1">
	                        		brd1_num_seq.nextval,
	                        	</when>
	                        	<when test="brd_type==2">
	                        		brd2_num_seq.nextval,
	                        	</when>
	                        	<when test="brd_type==3">
	                        		brd3_num_seq.nextval,
	                        	</when>
	                        	<when test="brd_type==4">
	                        		brd4_num_seq.nextval,
	                        	</when>
	                        </choose>
	                         #{brd_title},
	                         #{brd_content},
	                         SYSDATE,
	                         0,
	                         0,
	                         0,
	                         <choose>
	                        	<when test="brd_type==1">
	                        		brd1_num_seq.currval,
	                        	</when>
	                        	<when test="brd_type==2">
	                        		brd2_num_seq.currval,
	                        	</when>
	                        	<when test="brd_type==3">
	                        		brd3_num_seq.currval,
	                        	</when>
	                        	<when test="brd_type==4">
	                        		brd4_num_seq.currval,
	                        	</when>
	                        </choose>
	                        0,
	                        0,
	                        <choose>
	                        <when test="brd_type==3 or brd_type==4">
	                        	1
	                        </when>
	                        <otherwise>
	                        	null
	                        </otherwise>
	                        </choose>
	                       )
	                         	
	</insert>
	
	<select id="jwTypeBrdTotal" parameterType="int" resultType="int">
		select count(*) from Board where brd_type=#{brd_type}
	</select>
	
	<select id="jwTypeBrdList" parameterType="Board" resultType="Board">
		SELECT *
		    FROM
		    (SELECT rownum rn , a.*
		    FROM
		    (select b.*,d.dept_name,e.emp_name
		    from board b
		    inner join emp e
		    on e.emp_num=b.emp_num
		    inner join dept d
		    on d.dept_num = e.dept_num 
		    where b.brd_type=#{brd_type}
		    order by b.brd_date desc ) a)
		    WHERE rn BETWEEN #{start} and #{end}
	</select>		
	
	<select id="jwBoardSelOne" parameterType="hashMap" resultType="Board">
		select b.*,d.dept_name,e.emp_name
		    from board b
		    inner join emp e
		    on e.emp_num=b.emp_num
		    inner join dept d
		    on d.dept_num = e.dept_num 
		    where b.emp_num=#{emp_num} and b.brd_type=${brd_type} and b.brd_num=${brd_num}
	</select>
	
	
</mapper>